package NSM;

import static org.junit.jupiter.api.Assertions.*;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.security.NoSuchAlgorithmException;


import org.junit.jupiter.api.Test;

class nsmTest extends Main {

	@Test
	
	//ensures MD5 hash class is initializing
	public void MD5_IMPLEMENT() throws NoSuchAlgorithmException, IOException {

		MD5 encrypttest = new MD5();
		String md5Sum = encrypttest.fEncrypt("TestFiles/PythonHW1.py");
		
		assertEquals(md5Sum, "65de62daf13e0585983ddf5cc08a02a9");
		
	}
	
	@Test
	
	//ensures BoyerMoore is initialized and is working, finds characters in existing list and nonexisting list
	public void BM_EXIST_IMPLEMENT() throws NoSuchAlgorithmException, IOException {
		
		MD5 encrypttest = new MD5();
		String testmd5Sum = encrypttest.fEncrypt("TestFiles/lol.txt");
		BoyerMoore alg = new BoyerMoore(testmd5Sum);
		String exist = "RamdomCharacters**54bdfcbe07981121130d8218cf9db946**RamdomCharacters";
		String notexist = "RamdomCharacters**FILEDOESNTEXIST**RamdomCharacters";
		
		assertEquals(alg.search(exist), true);
		assertEquals(alg.search(notexist), false);
		
	}
	
	@Test
	
	//ensures db can be properly initialized into file while maintaing its integrity
	public void DB_INIT() throws IOException {
		
		StringBuilder db = new StringBuilder();
		BufferedReader in = new BufferedReader(new FileReader("db.txt"));
		String line = in.readLine();
		
		while (line != null) {
			db.append(line);
			line = in.readLine();
		}
		in.close();
		
		String contents = db.toString();
		assertEquals(contents.length(), 2097344);
		
		
		
	}
	
}
